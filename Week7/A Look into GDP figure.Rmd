---
title: "A Look into GDP figures"
author: "Sanjaya J Shetty"
date: "04/06/2021"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r, echo=FALSE}
library(knitr)
data <- read.table('GDP_DATA.txt', sep = ',',header = T)


data$li1LagOne <- dplyr::lead(data$li1, n = 1)

data$li1LagTwo <- dplyr::lead(data$li1, n= 2)

data$li2LagOne <- dplyr::lead(data$li2, n = 1)

data$li2LagTwo <- dplyr::lead(data$li2, n= 2)

data$LOGGDPLagOne <- dplyr::lead(data$LOGGDP, n = 1)

data$GrowthRateLagOne <-  dplyr::lead(data$GrowthRate, n =1)

data$PredValue <- exp((0.746-0.425*data$li1LagTwo) - (0.131*data$li2LagOne))/(1+exp((0.746-0.425*data$li1LagTwo) - (0.131*data$li2LagOne)))

table <- table(ActualValue = data$GDPIMPR, PredictedValue = data$PredValue >0.5)

model1 <- lm(formula = GrowthRate~LOGGDPLagOne+GrowthRateLagOne+T,data = data)

model2 <- lm( formula = GrowthRate~GrowthRateLagOne+li1LagOne+li2LagOne, data = data)
dataResidual <- data.frame(model2$residuals)

rownames(dataResidual) <- 1:262
colnames(dataResidual) <- 'Error'

dataResidual <- tibble::add_row(dataResidual, Error = NA)
dataResidual <- tibble::add_row(dataResidual, Error = NA)

data <- cbind(data, dataResidual)

data$ErrorLagOne <- dplyr::lead(data$Error, n =1)

```

## Answers

* **a)** and **b)** 

![](/home/sanjaya/Personal not your shit/H./Online Classes/R programming/Econometrics/Week7/0001.jpg)


* **c)**
```{r, echo=FALSE}
dataSample <- data[,c('Date', "PredValue")]
kable(dataSample, format = 'markdown')
```


```{r, echo=FALSE}
kable(table, format = 'markdown')
```

The hit rate = 0.6091


* **d)**

```{r, echo=FALSE}
summary(model1)
```

* **e)**

```{r, echo=FALSE}
summary(model2)
```

* **f)**
```{r, echo=FALSE}

lmtest::bgtest(Error ~ GrowthRateLagOne + li1LagOne + li2LagOne + 
                   ErrorLagOne, data = data, order = 1)
```

* **g)**
![](/home/sanjaya/Personal not your shit/H./Online Classes/R programming/Econometrics/Week7/000003.png)



## Method

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE)
```

### Load the Data
```{r}
data <- read.table('GDP_DATA.txt', sep = ',',header = T)

head(data)
```

```{r}

data$li1LagOne <- dplyr::lead(data$li1, n = 1)

data$li1LagTwo <- dplyr::lead(data$li1, n= 2)

data$li2LagOne <- dplyr::lead(data$li2, n = 1)

data$li2LagTwo <- dplyr::lead(data$li2, n= 2)

data$LOGGDPLagOne <- dplyr::lead(data$LOGGDP, n = 1)

data$GrowthRateLagOne <-  dplyr::lead(data$GrowthRate, n =1)

```


```{r}

data$PredValue <- exp((0.746-0.425*data$li1LagTwo) - (0.131*data$li2LagOne))/(1+exp((0.746-0.425*data$li1LagTwo) - (0.131*data$li2LagOne)))


head(data)
```

```{r}

table <- table(ActualValue = data$GDPIMPR, PredictedValue = data$PredValue >0.5)

table
```

```{r}

((table[1,1]+table[2,2])/sum(table))*100

```

```{r}

model1 <- lm(formula = GrowthRate~LOGGDPLagOne+GrowthRateLagOne+T,data = data)

summary(model1)

```

```{r}
model2 <- lm( formula = GrowthRate~GrowthRateLagOne+li1LagOne+li2LagOne, data = data)

summary(model2)
```

```{r}
model3 <- lm( formula = GrowthRate~GrowthRateLagOne+li1LagTwo+li2LagOne, data = data)

summary(model3)

```


```{r}
model4 <- lm( formula = GrowthRate~GrowthRateLagOne+li1LagOne+li2LagTwo, data = data)

summary(model4)

```


```{r}
model5 <- lm( formula = GrowthRate~GrowthRateLagOne+li1LagTwo+li2LagTwo, data = data)

summary(model5)

```

```{r}
dataResidual <- data.frame(model2$residuals)

rownames(dataResidual) <- 1:262
colnames(dataResidual) <- 'Error'

dataResidual <- tibble::add_row(dataResidual, Error = NA)
dataResidual <- tibble::add_row(dataResidual, Error = NA)

```


```{r}

data <- cbind(data, dataResidual)

data$ErrorLagOne <- dplyr::lead(data$Error, n =1)

```


```{r}

lmtest::bgtest(Error ~ GrowthRateLagOne + li1LagOne + li2LagOne + 
                   ErrorLagOne, data = data, order = 1)
```

```{r}
dataForcast <- data.frame(model2$fitted.values)

rownames(dataForcast) <- 1:262
colnames(dataForcast) <- 'Forcast'

dataForcast <- tibble::add_row(dataForcast, Forcast = NA)
dataForcast <- tibble::add_row(dataForcast, Forcast = NA)


```

```{r}
data <- cbind(data, dataForcast)

head(data)
```

```{r}
dataGraphing <- data[,c("Date", "GrowthRate", "Forcast")]

dataGraphing <- tail(dataGraphing, 20)

head(dataGraphing)
```

```{r}
library(ggplot2)
ggplot(data = dataGraphing, aes(x = Date,group = 1))+
  geom_line(aes(y = Forcast, col = 'Forcast'))+
  geom_line(aes(y = GrowthRate, col = 'Growth Rate'))+
  labs(x = "Date", y = "")+
  theme(axis.text.x = element_text(angle = 90), legend.title = element_blank())+
  scale_color_manual(breaks = c("Forcast", "Growth Rate"),
                     values = c('chocolate1', "deepskyblue1"))

```








